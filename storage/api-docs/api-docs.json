{
    "openapi": "3.0.0",
    "info": {
        "title": "Veloflott API",
        "description": "OpenAPI documentation for all available endpoints.",
        "version": "1.0.0"
    },
    "servers": [
        {
            "url": "http://localhost",
            "description": "Local server"
        }
    ],
    "paths": {
        "/api/me": {
            "get": {
                "tags": [
                    "Auth"
                ],
                "summary": "Get current authenticated user",
                "operationId": "0860ce0a48dc3d10e3e7e51662617304",
                "responses": {
                    "200": {
                        "description": "Current user returned"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/users": {
            "get": {
                "tags": [
                    "Users"
                ],
                "summary": "List users (admin only)",
                "operationId": "a89fbe482e1790700d2546da4075169b",
                "parameters": [
                    {
                        "name": "role",
                        "in": "query",
                        "description": "Filter by role",
                        "required": false,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "is_active",
                        "in": "query",
                        "description": "Filter by active status",
                        "required": false,
                        "schema": {
                            "type": "boolean"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of users"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/users/{id}/role": {
            "put": {
                "tags": [
                    "Users"
                ],
                "summary": "Update user role (admin only)",
                "operationId": "a7ead5ee431a36525d6c11584f9ed6e6",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "role"
                                ],
                                "properties": {
                                    "role": {
                                        "type": "string",
                                        "example": "ADMIN"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Role updated"
                    },
                    "400": {
                        "description": "Bad request"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/users/{id}/toggle-status": {
            "post": {
                "tags": [
                    "Users"
                ],
                "summary": "Toggle user active status (admin only)",
                "operationId": "06bfc33554c8eb7430623f4528bafba4",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Status toggled"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/user": {
            "get": {
                "tags": [
                    "Auth"
                ],
                "summary": "Get authenticated user (Sanctum)",
                "operationId": "a5bf41477af34bd3bd64b75110db13ee",
                "responses": {
                    "200": {
                        "description": "Current user returned"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/login": {
            "get": {
                "tags": [
                    "Auth"
                ],
                "summary": "Login endpoint (placeholder)",
                "operationId": "16ead6f805a6404d72164996407e9743",
                "responses": {
                    "200": {
                        "description": "Message returned"
                    }
                }
            }
        },
        "/api/auth/authorization-url": {
            "get": {
                "tags": [
                    "Auth"
                ],
                "summary": "Get OAuth2 authorization URL (public)",
                "operationId": "a4fadb2e604f80113e341953902c7b75",
                "parameters": [
                    {
                        "name": "redirect_url",
                        "in": "query",
                        "description": "Optional client redirect URL to include in the authorization flow",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "format": "uri"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Authorization URL payload returned"
                    }
                }
            }
        },
        "/api/auth/authorize": {
            "post": {
                "tags": [
                    "Auth"
                ],
                "summary": "OAuth2 authorization callback (public)",
                "operationId": "075901d3c75b8395892955cada06163b",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "code",
                                    "state"
                                ],
                                "properties": {
                                    "code": {
                                        "type": "string",
                                        "example": "abc123"
                                    },
                                    "state": {
                                        "type": "string",
                                        "example": "opaque-state"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Tokens/user info returned"
                    },
                    "400": {
                        "description": "Invalid payload or state mismatch"
                    }
                }
            }
        },
        "/api/customers": {
            "post": {
                "tags": [
                    "Customers"
                ],
                "summary": "Create a new customer",
                "operationId": "e31befb2cdce12325f8202029581e84f",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "first_name",
                                    "last_name"
                                ],
                                "properties": {
                                    "first_name": {
                                        "type": "string",
                                        "example": "Jean"
                                    },
                                    "last_name": {
                                        "type": "string",
                                        "example": "Dupont"
                                    },
                                    "email": {
                                        "type": "string",
                                        "format": "email",
                                        "example": "jean.dupont@example.com",
                                        "nullable": true
                                    },
                                    "phone": {
                                        "type": "string",
                                        "example": "+33612345678",
                                        "nullable": true
                                    },
                                    "identity_document_type": {
                                        "type": "string",
                                        "example": "Carte d'identité",
                                        "nullable": true
                                    },
                                    "identity_document_number": {
                                        "type": "string",
                                        "example": "AB123456",
                                        "nullable": true
                                    },
                                    "height": {
                                        "description": "Height in cm",
                                        "type": "integer",
                                        "example": 175,
                                        "nullable": true
                                    },
                                    "weight": {
                                        "description": "Weight in kg",
                                        "type": "integer",
                                        "example": 75,
                                        "nullable": true
                                    },
                                    "address": {
                                        "type": "string",
                                        "example": "123 Rue de la Paix, 75001 Paris",
                                        "nullable": true
                                    },
                                    "notes": {
                                        "type": "string",
                                        "example": "Client régulier",
                                        "nullable": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Customer created successfully"
                    },
                    "400": {
                        "description": "Validation error"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_customers permission"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/customers/search": {
            "get": {
                "tags": [
                    "Customers"
                ],
                "summary": "Search customers by name, email, or phone",
                "operationId": "5f60d69596d0ef0ad3eca7dbb5a9e6a2",
                "parameters": [
                    {
                        "name": "query",
                        "in": "query",
                        "description": "Search query to match against first name, last name, email, or phone",
                        "required": false,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of matching customers"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires view_customers permission"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/customers/{id}": {
            "get": {
                "tags": [
                    "Customers"
                ],
                "summary": "Get customer details with rental history and statistics",
                "operationId": "0e254a7934b3686367479110390b34c9",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Customer details including rental history and statistics"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires view_customers permission"
                    },
                    "404": {
                        "description": "Customer not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "put": {
                "tags": [
                    "Customers"
                ],
                "summary": "Update customer information",
                "operationId": "6a23d336b9c77a7a4a676867adcfb28b",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "first_name",
                                    "last_name"
                                ],
                                "properties": {
                                    "first_name": {
                                        "type": "string",
                                        "example": "Jean"
                                    },
                                    "last_name": {
                                        "type": "string",
                                        "example": "Dupont"
                                    },
                                    "email": {
                                        "type": "string",
                                        "format": "email",
                                        "example": "jean.dupont@example.com",
                                        "nullable": true
                                    },
                                    "phone": {
                                        "type": "string",
                                        "example": "+33612345678",
                                        "nullable": true
                                    },
                                    "identity_document_type": {
                                        "type": "string",
                                        "example": "Passeport",
                                        "nullable": true
                                    },
                                    "identity_document_number": {
                                        "type": "string",
                                        "example": "CD789012",
                                        "nullable": true
                                    },
                                    "height": {
                                        "description": "Height in cm",
                                        "type": "integer",
                                        "example": 180,
                                        "nullable": true
                                    },
                                    "weight": {
                                        "description": "Weight in kg",
                                        "type": "integer",
                                        "example": 80,
                                        "nullable": true
                                    },
                                    "address": {
                                        "type": "string",
                                        "example": "456 Avenue des Champs, 75008 Paris",
                                        "nullable": true
                                    },
                                    "notes": {
                                        "type": "string",
                                        "example": "Préfère les vélos de route",
                                        "nullable": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Customer updated successfully"
                    },
                    "400": {
                        "description": "Validation error"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_customers permission"
                    },
                    "404": {
                        "description": "Customer not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/customers/{id}/toggle-risky": {
            "post": {
                "tags": [
                    "Customers"
                ],
                "summary": "Toggle customer risky flag",
                "operationId": "4d4bb848847312e7db059da56898b054",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Risky flag toggled successfully"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_customers permission"
                    },
                    "404": {
                        "description": "Customer not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/customers/{id}/annotation": {
            "post": {
                "tags": [
                    "Customers"
                ],
                "summary": "Annotate customer with notes and risky flag",
                "operationId": "6a9aef2417bf25031bfd76fd4b4d189c",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "is_risky_customer"
                                ],
                                "properties": {
                                    "annotation": {
                                        "description": "Free text annotation (max 1000 characters)",
                                        "type": "string",
                                        "example": "Président !",
                                        "nullable": true
                                    },
                                    "is_risky_customer": {
                                        "description": "Mark customer as risky",
                                        "type": "boolean",
                                        "example": false
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Customer annotated successfully"
                    },
                    "400": {
                        "description": "Validation error"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_customers permission"
                    },
                    "404": {
                        "description": "Customer not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/fleet/brands": {
            "get": {
                "tags": [
                    "Fleet - Brands"
                ],
                "summary": "List all bike brands",
                "operationId": "b02c2db0cfbe3f580d285d499cdba203",
                "responses": {
                    "200": {
                        "description": "List of bike brands"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires view_bikes permission"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "Fleet - Brands"
                ],
                "summary": "Create a new bike brand",
                "operationId": "77972baab8bb5aae74907d4687092c24",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "name"
                                ],
                                "properties": {
                                    "name": {
                                        "type": "string",
                                        "maxLength": 100,
                                        "example": "Specialized"
                                    },
                                    "logo_url": {
                                        "type": "string",
                                        "format": "uri",
                                        "maxLength": 500,
                                        "example": "https://example.com/logo.png",
                                        "nullable": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Brand created successfully"
                    },
                    "400": {
                        "description": "Validation error"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_bikes permission"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/fleet/brands/{id}": {
            "put": {
                "tags": [
                    "Fleet - Brands"
                ],
                "summary": "Update a bike brand",
                "operationId": "0d7071a9abd09a0ab0346ea3fe7176f6",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "name"
                                ],
                                "properties": {
                                    "name": {
                                        "type": "string",
                                        "maxLength": 100,
                                        "example": "Specialized"
                                    },
                                    "logo_url": {
                                        "type": "string",
                                        "format": "uri",
                                        "maxLength": 500,
                                        "example": "https://example.com/logo.png",
                                        "nullable": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Brand updated successfully"
                    },
                    "400": {
                        "description": "Validation error"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_bikes permission"
                    },
                    "404": {
                        "description": "Brand not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "delete": {
                "tags": [
                    "Fleet - Brands"
                ],
                "summary": "Delete a bike brand",
                "operationId": "04d647c597213142fb126065a2da8946",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "responses": {
                    "204": {
                        "description": "Brand deleted successfully"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_bikes permission"
                    },
                    "404": {
                        "description": "Brand not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/fleet/models": {
            "get": {
                "tags": [
                    "Fleet - Models"
                ],
                "summary": "List all bike models with optional brand filter",
                "operationId": "0faf3abcc09260e7210ca384533bb319",
                "parameters": [
                    {
                        "name": "brand_id",
                        "in": "query",
                        "description": "Filter models by brand ID",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of bike models"
                    },
                    "400": {
                        "description": "Validation error"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires view_bikes permission"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "Fleet - Models"
                ],
                "summary": "Create a new bike model",
                "operationId": "7e45bbd395740bdeaf68b4a658ff7c82",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "name",
                                    "brand_id"
                                ],
                                "properties": {
                                    "name": {
                                        "type": "string",
                                        "maxLength": 100,
                                        "example": "Tarmac SL7"
                                    },
                                    "brand_id": {
                                        "type": "string",
                                        "format": "uuid",
                                        "example": "550e8400-e29b-41d4-a716-446655440000"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Model created successfully"
                    },
                    "400": {
                        "description": "Validation error"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_bikes permission"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/fleet/models/{id}": {
            "get": {
                "tags": [
                    "Fleet - Models"
                ],
                "summary": "Get bike model details",
                "operationId": "c46d37fe522959b0589d04093df87e57",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Model details",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "id": {
                                            "type": "string",
                                            "format": "uuid"
                                        },
                                        "name": {
                                            "type": "string",
                                            "example": "Tarmac SL7"
                                        },
                                        "brand_id": {
                                            "type": "string",
                                            "format": "uuid"
                                        },
                                        "brand_name": {
                                            "type": "string",
                                            "example": "Specialized"
                                        },
                                        "brand_logo_url": {
                                            "type": "string",
                                            "format": "uri",
                                            "nullable": true
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires view_bikes permission"
                    },
                    "404": {
                        "description": "Model not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "put": {
                "tags": [
                    "Fleet - Models"
                ],
                "summary": "Update a bike model",
                "operationId": "17df148c373e7e1a7d933315ddb845ae",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "name",
                                    "brand_id"
                                ],
                                "properties": {
                                    "name": {
                                        "type": "string",
                                        "maxLength": 100,
                                        "example": "Tarmac SL7"
                                    },
                                    "brand_id": {
                                        "type": "string",
                                        "format": "uuid"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Model updated successfully"
                    },
                    "400": {
                        "description": "Validation error"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_bikes permission"
                    },
                    "404": {
                        "description": "Model not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "delete": {
                "tags": [
                    "Fleet - Models"
                ],
                "summary": "Delete a bike model",
                "operationId": "602a723d93aac06fd5b1eed94cef7f76",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "responses": {
                    "204": {
                        "description": "Model deleted successfully"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_bikes permission"
                    },
                    "404": {
                        "description": "Model not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/fleet/bikes": {
            "get": {
                "tags": [
                    "Fleet - Bikes"
                ],
                "summary": "List all bikes with filters",
                "operationId": "df24abb3188b536c1e656e135f75214d",
                "parameters": [
                    {
                        "name": "status",
                        "in": "query",
                        "description": "Filter by status",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "enum": [
                                "available",
                                "rented",
                                "maintenance",
                                "retired"
                            ]
                        }
                    },
                    {
                        "name": "category_id",
                        "in": "query",
                        "description": "Filter by category",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    },
                    {
                        "name": "brand_id",
                        "in": "query",
                        "description": "Filter by brand",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    },
                    {
                        "name": "model_id",
                        "in": "query",
                        "description": "Filter by model",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of bikes with photos",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "properties": {
                                            "id": {
                                                "type": "string",
                                                "format": "uuid"
                                            },
                                            "internal_number": {
                                                "type": "string"
                                            },
                                            "status": {
                                                "type": "string"
                                            },
                                            "brand": {
                                                "type": "object"
                                            },
                                            "model": {
                                                "type": "object"
                                            },
                                            "category": {
                                                "type": "object"
                                            },
                                            "frame_size": {
                                                "type": "object"
                                            },
                                            "year": {
                                                "type": "integer",
                                                "nullable": true
                                            },
                                            "color": {
                                                "type": "string",
                                                "nullable": true
                                            },
                                            "photos": {
                                                "description": "Array of photo URLs",
                                                "type": "array",
                                                "items": {
                                                    "type": "string",
                                                    "format": "uri"
                                                }
                                            }
                                        },
                                        "type": "object"
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires view_bikes permission"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "Fleet - Bikes"
                ],
                "summary": "Create a new bike",
                "operationId": "c5a84480c96d50a555862943b2e584e2",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "brand_id",
                                    "model_id",
                                    "category_id",
                                    "serial_number",
                                    "frame_number"
                                ],
                                "properties": {
                                    "brand_id": {
                                        "type": "string",
                                        "format": "uuid",
                                        "example": "550e8400-e29b-41d4-a716-446655440000"
                                    },
                                    "model_id": {
                                        "type": "string",
                                        "format": "uuid",
                                        "example": "550e8400-e29b-41d4-a716-446655440001"
                                    },
                                    "category_id": {
                                        "type": "string",
                                        "format": "uuid",
                                        "example": "550e8400-e29b-41d4-a716-446655440002"
                                    },
                                    "serial_number": {
                                        "type": "string",
                                        "example": "SN-2024-001"
                                    },
                                    "frame_number": {
                                        "type": "string",
                                        "example": "FN-2024-001"
                                    },
                                    "purchase_date": {
                                        "type": "string",
                                        "format": "date",
                                        "example": "2024-01-15",
                                        "nullable": true
                                    },
                                    "purchase_price": {
                                        "type": "number",
                                        "format": "float",
                                        "example": 1500,
                                        "nullable": true
                                    },
                                    "notes": {
                                        "type": "string",
                                        "example": "VTT électrique neuf",
                                        "nullable": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Bike created successfully"
                    },
                    "400": {
                        "description": "Validation error"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_bikes permission"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/fleet/bikes/{id}": {
            "get": {
                "tags": [
                    "Fleet - Bikes"
                ],
                "summary": "Get bike details",
                "operationId": "aee26c89ae05efc97f69f22bdcd571af",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Bike details with photos",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "id": {
                                            "type": "string",
                                            "format": "uuid"
                                        },
                                        "internal_number": {
                                            "type": "string"
                                        },
                                        "status": {
                                            "type": "string"
                                        },
                                        "brand": {
                                            "type": "string"
                                        },
                                        "model": {
                                            "type": "string"
                                        },
                                        "category": {
                                            "type": "string"
                                        },
                                        "frame_size": {
                                            "type": "object"
                                        },
                                        "year": {
                                            "type": "integer",
                                            "nullable": true
                                        },
                                        "serial_number": {
                                            "type": "string",
                                            "nullable": true
                                        },
                                        "color": {
                                            "type": "string",
                                            "nullable": true
                                        },
                                        "wheel_size": {
                                            "type": "string",
                                            "nullable": true
                                        },
                                        "purchase_price": {
                                            "type": "number",
                                            "nullable": true
                                        },
                                        "purchase_date": {
                                            "type": "string",
                                            "nullable": true
                                        },
                                        "notes": {
                                            "type": "string",
                                            "nullable": true
                                        },
                                        "photos": {
                                            "description": "Array of photo URLs",
                                            "type": "array",
                                            "items": {
                                                "type": "string",
                                                "format": "uri"
                                            }
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires view_bikes permission"
                    },
                    "404": {
                        "description": "Bike not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "put": {
                "tags": [
                    "Fleet - Bikes"
                ],
                "summary": "Update a bike",
                "operationId": "f4388fcf40e4201eaba8de8ba1ac974e",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "model_id",
                                    "category_id",
                                    "frame_size_unit"
                                ],
                                "properties": {
                                    "model_id": {
                                        "type": "string",
                                        "format": "uuid",
                                        "example": "550e8400-e29b-41d4-a716-446655440001"
                                    },
                                    "category_id": {
                                        "type": "string",
                                        "format": "uuid",
                                        "example": "550e8400-e29b-41d4-a716-446655440002"
                                    },
                                    "frame_size_unit": {
                                        "type": "string",
                                        "enum": [
                                            "cm",
                                            "inch",
                                            "letter"
                                        ],
                                        "example": "cm"
                                    },
                                    "frame_size_numeric": {
                                        "type": "number",
                                        "example": 54,
                                        "nullable": true
                                    },
                                    "frame_size_letter": {
                                        "type": "string",
                                        "enum": [
                                            "XS",
                                            "S",
                                            "M",
                                            "L",
                                            "XL",
                                            "XXL"
                                        ],
                                        "nullable": true
                                    },
                                    "year": {
                                        "type": "integer",
                                        "example": 2024,
                                        "nullable": true
                                    },
                                    "serial_number": {
                                        "type": "string",
                                        "example": "SN-2024-001",
                                        "nullable": true
                                    },
                                    "color": {
                                        "type": "string",
                                        "example": "Noir",
                                        "nullable": true
                                    },
                                    "wheel_size": {
                                        "type": "string",
                                        "enum": [
                                            "26",
                                            "27.5",
                                            "29",
                                            "700c"
                                        ],
                                        "nullable": true
                                    },
                                    "front_suspension": {
                                        "description": "Front suspension travel in mm",
                                        "type": "integer",
                                        "example": 120,
                                        "nullable": true
                                    },
                                    "rear_suspension": {
                                        "description": "Rear suspension travel in mm",
                                        "type": "integer",
                                        "example": 110,
                                        "nullable": true
                                    },
                                    "brake_type": {
                                        "type": "string",
                                        "enum": [
                                            "hydraulic_disc",
                                            "mechanical_disc",
                                            "rim"
                                        ],
                                        "nullable": true
                                    },
                                    "purchase_price": {
                                        "type": "number",
                                        "format": "float",
                                        "example": 1500,
                                        "nullable": true
                                    },
                                    "purchase_date": {
                                        "type": "string",
                                        "format": "date",
                                        "example": "2024-01-15",
                                        "nullable": true
                                    },
                                    "notes": {
                                        "type": "string",
                                        "example": "VTT électrique neuf",
                                        "nullable": true
                                    },
                                    "photos": {
                                        "description": "Array of photos: existing URLs (to keep) or base64 encoded images (to upload). Format: \"data:image/jpeg;base64,...\" or \"http://...\"",
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        },
                                        "nullable": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Bike updated successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "id": {
                                            "type": "string",
                                            "format": "uuid"
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Bike updated successfully"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Validation error or bike cannot be modified"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_bikes permission"
                    },
                    "404": {
                        "description": "Bike not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/fleet/bikes/{id}/photos": {
            "post": {
                "tags": [
                    "Fleet - Bikes"
                ],
                "summary": "Upload a photo for a bike",
                "operationId": "25a25d33b37691428e669a1c49a06605",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "multipart/form-data": {
                            "schema": {
                                "required": [
                                    "photo"
                                ],
                                "properties": {
                                    "photo": {
                                        "description": "Photo file (max 5MB)",
                                        "type": "string",
                                        "format": "binary"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Photo uploaded successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "bike_id": {
                                            "type": "string",
                                            "format": "uuid"
                                        },
                                        "photo_url": {
                                            "type": "string",
                                            "format": "uri"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Validation error"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_bikes permission"
                    },
                    "404": {
                        "description": "Bike not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "delete": {
                "tags": [
                    "Fleet - Bikes"
                ],
                "summary": "Delete a photo from a bike",
                "operationId": "54176a16ad29febf932bd793c6f084fc",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "photo_url"
                                ],
                                "properties": {
                                    "photo_url": {
                                        "type": "string",
                                        "format": "uri",
                                        "example": "http://localhost/storage/bikes/{id}/{filename}"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "204": {
                        "description": "Photo deleted successfully"
                    },
                    "400": {
                        "description": "Validation error"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_bikes permission"
                    },
                    "404": {
                        "description": "Bike not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/fleet/bikes/{id}/retire": {
            "post": {
                "tags": [
                    "Fleet - Bikes"
                ],
                "summary": "Retire a bike from the fleet",
                "operationId": "cbd42b8c23859e7de6bbb235d39acd36",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "reason"
                                ],
                                "properties": {
                                    "reason": {
                                        "type": "string",
                                        "enum": [
                                            "sold",
                                            "stolen",
                                            "permanently_out_of_service",
                                            "other"
                                        ],
                                        "example": "sold"
                                    },
                                    "comment": {
                                        "type": "string",
                                        "maxLength": 1000,
                                        "example": "Sold to customer"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Bike retired successfully"
                    },
                    "400": {
                        "description": "Cannot retire a bike that is currently rented"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_bikes permission"
                    },
                    "404": {
                        "description": "Bike not found"
                    },
                    "422": {
                        "description": "Validation error"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/fleet/bikes/{id}/status": {
            "put": {
                "tags": [
                    "Fleet - Bikes"
                ],
                "summary": "Change bike status",
                "description": "Change the status of a bike (available, maintenance, unavailable). Rented bikes cannot be changed manually.",
                "operationId": "fd8ae878dc04f2c791230c409405f457",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "status"
                                ],
                                "properties": {
                                    "status": {
                                        "description": "New bike status",
                                        "type": "string",
                                        "enum": [
                                            "available",
                                            "maintenance",
                                            "unavailable"
                                        ],
                                        "example": "unavailable"
                                    },
                                    "unavailability_reason": {
                                        "description": "Required when status is unavailable",
                                        "type": "string",
                                        "enum": [
                                            "reserved",
                                            "loaned",
                                            "other"
                                        ],
                                        "example": "reserved"
                                    },
                                    "unavailability_comment": {
                                        "description": "Optional comment",
                                        "type": "string",
                                        "maxLength": 1000,
                                        "example": "Reserved for VIP client"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Bike status changed successfully"
                    },
                    "400": {
                        "description": "Domain rule violation (e.g., cannot change status of rented bike)"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_bikes permission"
                    },
                    "404": {
                        "description": "Bike not found"
                    },
                    "422": {
                        "description": "Validation error"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/fleet/bikes/{id}/status-history": {
            "get": {
                "tags": [
                    "Fleet - Bikes"
                ],
                "summary": "Get bike status change history",
                "description": "Retrieve the complete history of status changes for a specific bike",
                "operationId": "6c158aa195f56edf31d0139c5619e411",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Status history retrieved successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "properties": {
                                                    "id": {
                                                        "type": "string",
                                                        "format": "uuid"
                                                    },
                                                    "old_status": {
                                                        "type": "string",
                                                        "example": "available"
                                                    },
                                                    "old_status_label": {
                                                        "type": "string",
                                                        "example": "Disponible"
                                                    },
                                                    "new_status": {
                                                        "type": "string",
                                                        "example": "unavailable"
                                                    },
                                                    "new_status_label": {
                                                        "type": "string",
                                                        "example": "Indisponible"
                                                    },
                                                    "unavailability_reason": {
                                                        "type": "string",
                                                        "example": "reserved",
                                                        "nullable": true
                                                    },
                                                    "unavailability_reason_label": {
                                                        "type": "string",
                                                        "example": "Réservé",
                                                        "nullable": true
                                                    },
                                                    "unavailability_comment": {
                                                        "type": "string",
                                                        "example": "Reserved for VIP",
                                                        "nullable": true
                                                    },
                                                    "changed_at": {
                                                        "type": "string",
                                                        "format": "date-time",
                                                        "example": "2026-02-06 10:30:00"
                                                    }
                                                },
                                                "type": "object"
                                            }
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires view_bikes permission"
                    },
                    "404": {
                        "description": "Bike not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/fleet/categories": {
            "get": {
                "tags": [
                    "Fleet - Categories"
                ],
                "summary": "List all bike categories",
                "operationId": "ecad3d0425372ed8c399d64b5a5d2699",
                "responses": {
                    "200": {
                        "description": "List of categories"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires view_fleet permission"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "Fleet - Categories"
                ],
                "summary": "Create a new bike category",
                "operationId": "d4eddbffe307b8dd5462ba7e157ea071",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "name"
                                ],
                                "properties": {
                                    "name": {
                                        "type": "string",
                                        "example": "XC"
                                    },
                                    "slug": {
                                        "description": "URL-friendly identifier (lowercase, alphanumeric and dashes only)",
                                        "type": "string",
                                        "example": "xc",
                                        "nullable": true
                                    },
                                    "description": {
                                        "type": "string",
                                        "example": "Vélos cross-country",
                                        "nullable": true
                                    },
                                    "parent_id": {
                                        "description": "ID of parent category for hierarchical organization",
                                        "type": "string",
                                        "format": "uuid",
                                        "example": "550e8400-e29b-41d4-a716-446655440003",
                                        "nullable": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Category created successfully"
                    },
                    "400": {
                        "description": "Validation error"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_fleet permission"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/fleet/categories/{id}": {
            "put": {
                "tags": [
                    "Fleet - Categories"
                ],
                "summary": "Update a bike category",
                "operationId": "b8291b10bf50470b988a9c724c05e150",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "name": {
                                        "type": "string",
                                        "example": "Enduro"
                                    },
                                    "slug": {
                                        "description": "URL-friendly identifier",
                                        "type": "string",
                                        "example": "enduro",
                                        "nullable": true
                                    },
                                    "description": {
                                        "type": "string",
                                        "example": "Vélos enduro all-mountain",
                                        "nullable": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Category updated successfully"
                    },
                    "400": {
                        "description": "Validation error"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_fleet permission"
                    },
                    "404": {
                        "description": "Category not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "delete": {
                "tags": [
                    "Fleet - Categories"
                ],
                "summary": "Delete a bike category",
                "operationId": "67224edb9bbeb7266798e988b8cc8258",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "responses": {
                    "204": {
                        "description": "Category deleted successfully"
                    },
                    "400": {
                        "description": "Cannot delete category with associated bikes"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_fleet permission"
                    },
                    "404": {
                        "description": "Category not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/fleet/categories/{categoryId}/rates": {
            "post": {
                "tags": [
                    "Fleet - Rates"
                ],
                "summary": "Create or update rate for a category",
                "operationId": "23402035714cb59fc0212f84ac3e13a4",
                "parameters": [
                    {
                        "name": "categoryId",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "duration",
                                    "price"
                                ],
                                "properties": {
                                    "duration": {
                                        "type": "string",
                                        "enum": [
                                            "half_day",
                                            "full_day",
                                            "two_days",
                                            "three_days",
                                            "week",
                                            "custom"
                                        ],
                                        "example": "full_day"
                                    },
                                    "price": {
                                        "type": "number",
                                        "format": "float",
                                        "example": 25
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Rate created or updated successfully"
                    },
                    "400": {
                        "description": "Validation error"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_fleet permission"
                    },
                    "404": {
                        "description": "Category not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/fleet/rates": {
            "get": {
                "tags": [
                    "Fleet - Rates"
                ],
                "summary": "List all rates",
                "operationId": "095ead02c31ee478731b76e255268cbc",
                "parameters": [
                    {
                        "name": "category_id",
                        "in": "query",
                        "description": "Filter by category ID",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    },
                    {
                        "name": "bike_id",
                        "in": "query",
                        "description": "Filter by bike ID",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of rates"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires view_fleet permission"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/fleet/rates/{id}": {
            "put": {
                "tags": [
                    "Fleet - Rates"
                ],
                "summary": "Update a rate",
                "operationId": "901919571bb0d7f67c8a12c3498b173e",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "duration": {
                                        "type": "string",
                                        "enum": [
                                            "half_day",
                                            "full_day",
                                            "two_days",
                                            "three_days",
                                            "week",
                                            "custom"
                                        ],
                                        "example": "full_day"
                                    },
                                    "price": {
                                        "type": "number",
                                        "format": "float",
                                        "example": 30
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Rate updated successfully"
                    },
                    "400": {
                        "description": "Validation error"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_fleet permission"
                    },
                    "404": {
                        "description": "Rate not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "delete": {
                "tags": [
                    "Fleet - Rates"
                ],
                "summary": "Delete a rate",
                "operationId": "b5fdcca9b024b31ade0569f527ac92eb",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "responses": {
                    "204": {
                        "description": "Rate deleted successfully"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_fleet permission"
                    },
                    "404": {
                        "description": "Rate not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/rentals": {
            "get": {
                "tags": [
                    "Rentals"
                ],
                "summary": "List rental history with filters and pagination",
                "operationId": "f1a246fa0b0fe599cd0b251bc0daf908",
                "parameters": [
                    {
                        "name": "customer_id",
                        "in": "query",
                        "description": "Filter by customer ID",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    },
                    {
                        "name": "status",
                        "in": "query",
                        "description": "Filter by rental status",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "enum": [
                                "pending",
                                "active",
                                "completed",
                                "cancelled"
                            ]
                        }
                    },
                    {
                        "name": "start_date",
                        "in": "query",
                        "description": "Filter rentals starting from this date",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "format": "date"
                        }
                    },
                    {
                        "name": "end_date",
                        "in": "query",
                        "description": "Filter rentals until this date",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "format": "date"
                        }
                    },
                    {
                        "name": "page",
                        "in": "query",
                        "description": "Page number",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "default": 1
                        }
                    },
                    {
                        "name": "per_page",
                        "in": "query",
                        "description": "Items per page",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "default": 20,
                            "maximum": 100
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Paginated list of rentals with detailed information",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "properties": {
                                                    "id": {
                                                        "type": "string",
                                                        "format": "uuid"
                                                    },
                                                    "customer_id": {
                                                        "type": "string",
                                                        "format": "uuid"
                                                    },
                                                    "customer_name": {
                                                        "type": "string"
                                                    },
                                                    "start_date": {
                                                        "type": "string",
                                                        "format": "date-time"
                                                    },
                                                    "expected_return_date": {
                                                        "type": "string",
                                                        "format": "date-time"
                                                    },
                                                    "actual_return_date": {
                                                        "type": "string",
                                                        "format": "date-time",
                                                        "nullable": true
                                                    },
                                                    "bikes": {
                                                        "type": "array",
                                                        "items": {
                                                            "type": "string"
                                                        }
                                                    },
                                                    "status": {
                                                        "type": "string"
                                                    },
                                                    "duration": {
                                                        "type": "string"
                                                    },
                                                    "total_amount": {
                                                        "type": "number"
                                                    },
                                                    "deposit_amount": {
                                                        "type": "number"
                                                    },
                                                    "deposit_status": {
                                                        "type": "string"
                                                    },
                                                    "deposit_retained": {
                                                        "type": "number",
                                                        "nullable": true
                                                    },
                                                    "created_at": {
                                                        "type": "string",
                                                        "format": "date-time"
                                                    }
                                                },
                                                "type": "object"
                                            }
                                        },
                                        "meta": {
                                            "properties": {
                                                "total": {
                                                    "type": "integer"
                                                },
                                                "current_page": {
                                                    "type": "integer"
                                                },
                                                "per_page": {
                                                    "type": "integer"
                                                },
                                                "last_page": {
                                                    "type": "integer"
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires view_rentals permission"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "Rentals"
                ],
                "summary": "Create a new rental",
                "operationId": "b8b33e90c509e401e3125d9eeddcdef6",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "customer_id",
                                    "start_date",
                                    "duration",
                                    "deposit_amount",
                                    "bike_items"
                                ],
                                "properties": {
                                    "customer_id": {
                                        "type": "string",
                                        "format": "uuid",
                                        "example": "550e8400-e29b-41d4-a716-446655440000"
                                    },
                                    "start_date": {
                                        "type": "string",
                                        "format": "date-time",
                                        "example": "2024-03-15T10:00:00Z"
                                    },
                                    "duration": {
                                        "type": "string",
                                        "enum": [
                                            "half_day",
                                            "full_day",
                                            "two_days",
                                            "three_days",
                                            "week",
                                            "custom"
                                        ],
                                        "example": "full_day"
                                    },
                                    "custom_end_date": {
                                        "description": "Required when duration is \"custom\"",
                                        "type": "string",
                                        "format": "date-time",
                                        "nullable": true
                                    },
                                    "deposit_amount": {
                                        "type": "number",
                                        "format": "float",
                                        "example": 200
                                    },
                                    "bike_items": {
                                        "type": "array",
                                        "items": {
                                            "properties": {
                                                "bike_id": {
                                                    "type": "string",
                                                    "format": "uuid"
                                                },
                                                "daily_rate": {
                                                    "type": "number",
                                                    "format": "float"
                                                },
                                                "quantity": {
                                                    "type": "integer",
                                                    "example": 1
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "equipment_items": {
                                        "type": "array",
                                        "items": {
                                            "properties": {
                                                "type": {
                                                    "type": "string",
                                                    "enum": [
                                                        "helmet",
                                                        "knee_pads",
                                                        "elbow_pads",
                                                        "gloves",
                                                        "backpack",
                                                        "lock",
                                                        "other"
                                                    ]
                                                },
                                                "quantity": {
                                                    "type": "integer"
                                                },
                                                "price_per_unit": {
                                                    "type": "number",
                                                    "format": "float"
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "nullable": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Rental created successfully"
                    },
                    "400": {
                        "description": "Validation error or bike not available"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_rentals permission"
                    },
                    "404": {
                        "description": "Customer or bike not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/rentals/{id}/checkin": {
            "post": {
                "tags": [
                    "Rentals"
                ],
                "summary": "Check-in a rental (record customer settings)",
                "operationId": "ba2f9e35711a422918025d0f99033e31",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "bikes_check_in"
                                ],
                                "properties": {
                                    "bikes_check_in": {
                                        "type": "array",
                                        "items": {
                                            "properties": {
                                                "bike_id": {
                                                    "type": "string",
                                                    "format": "uuid"
                                                },
                                                "client_height": {
                                                    "description": "Client height in cm",
                                                    "type": "integer",
                                                    "example": 175
                                                },
                                                "client_weight": {
                                                    "description": "Client weight in kg",
                                                    "type": "integer",
                                                    "example": 75
                                                },
                                                "saddle_height": {
                                                    "description": "Saddle height in cm",
                                                    "type": "integer",
                                                    "example": 75
                                                },
                                                "front_suspension_pressure": {
                                                    "description": "Front suspension pressure in PSI",
                                                    "type": "integer",
                                                    "example": 80,
                                                    "nullable": true
                                                },
                                                "rear_suspension_pressure": {
                                                    "description": "Rear suspension pressure in PSI",
                                                    "type": "integer",
                                                    "example": 100,
                                                    "nullable": true
                                                },
                                                "pedal_type": {
                                                    "description": "Type of pedals mounted",
                                                    "type": "string",
                                                    "example": "SPD",
                                                    "nullable": true
                                                },
                                                "notes": {
                                                    "type": "string",
                                                    "example": "Client prefers softer suspension",
                                                    "nullable": true
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "customer_signature": {
                                        "description": "Base64 encoded signature image",
                                        "type": "string",
                                        "nullable": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Check-in completed, rental is now active"
                    },
                    "400": {
                        "description": "Validation error or rental cannot be checked in"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires create_rentals permission"
                    },
                    "404": {
                        "description": "Rental not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/rentals/{id}/checkout": {
            "post": {
                "tags": [
                    "Rentals"
                ],
                "summary": "Check-out a rental (process return)",
                "operationId": "9fe6160a100bd6587d19a83e19e3f9ef",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "actual_return_date",
                                    "bikes_condition"
                                ],
                                "properties": {
                                    "actual_return_date": {
                                        "type": "string",
                                        "format": "date-time",
                                        "example": "2024-03-15T18:00:00Z"
                                    },
                                    "bikes_condition": {
                                        "type": "array",
                                        "items": {
                                            "properties": {
                                                "bike_id": {
                                                    "type": "string",
                                                    "format": "uuid"
                                                },
                                                "condition": {
                                                    "type": "string",
                                                    "enum": [
                                                        "ok",
                                                        "minor_damage",
                                                        "major_damage"
                                                    ]
                                                },
                                                "damage_description": {
                                                    "type": "string",
                                                    "nullable": true
                                                },
                                                "damage_photos": {
                                                    "type": "array",
                                                    "items": {
                                                        "description": "Photo URLs",
                                                        "type": "string"
                                                    },
                                                    "nullable": true
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "deposit_retained": {
                                        "description": "Amount of deposit to retain (for damages)",
                                        "type": "number",
                                        "format": "float",
                                        "nullable": true
                                    },
                                    "hourly_late_rate": {
                                        "description": "Hourly rate for late returns",
                                        "type": "number",
                                        "format": "float",
                                        "example": 10
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Rental checked out successfully"
                    },
                    "400": {
                        "description": "Validation error or rental cannot be checked out"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_rentals permission"
                    },
                    "404": {
                        "description": "Rental not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/rentals/{id}/cancel": {
            "post": {
                "tags": [
                    "Rentals"
                ],
                "summary": "Cancel a rental",
                "operationId": "3ae5fb818efa4613544a86972dada4cf",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "cancellation_reason"
                                ],
                                "properties": {
                                    "cancellation_reason": {
                                        "type": "string",
                                        "maxLength": 500,
                                        "minLength": 5,
                                        "example": "Customer requested cancellation due to weather conditions"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Rental cancelled successfully. Deposit status changed to released and bikes marked as available.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "rental_id": {
                                            "type": "string",
                                            "format": "uuid"
                                        },
                                        "status": {
                                            "type": "string",
                                            "example": "cancelled"
                                        },
                                        "cancellation_reason": {
                                            "type": "string"
                                        },
                                        "deposit_status": {
                                            "type": "string",
                                            "example": "released"
                                        },
                                        "message": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Cannot cancel rental - rental is not in pending status"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires create_rentals permission"
                    },
                    "404": {
                        "description": "Rental not found"
                    },
                    "422": {
                        "description": "Validation error - cancellation reason required"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/rentals/{id}": {
            "get": {
                "tags": [
                    "Rentals"
                ],
                "summary": "Get rental details by ID",
                "operationId": "04092764dfb5335c24837daf428f1bcb",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Rental ID",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Detailed rental information with customer, bikes, and equipments",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "id": {
                                            "type": "string",
                                            "format": "uuid"
                                        },
                                        "customer": {
                                            "properties": {
                                                "id": {
                                                    "type": "string",
                                                    "format": "uuid"
                                                },
                                                "first_name": {
                                                    "type": "string"
                                                },
                                                "last_name": {
                                                    "type": "string"
                                                },
                                                "email": {
                                                    "type": "string"
                                                },
                                                "phone": {
                                                    "type": "string",
                                                    "nullable": true
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "start_date": {
                                            "type": "string",
                                            "format": "date-time"
                                        },
                                        "expected_return_date": {
                                            "type": "string",
                                            "format": "date-time"
                                        },
                                        "actual_return_date": {
                                            "type": "string",
                                            "format": "date-time",
                                            "nullable": true
                                        },
                                        "duration": {
                                            "type": "string"
                                        },
                                        "deposit_amount": {
                                            "type": "number"
                                        },
                                        "total_amount": {
                                            "type": "number"
                                        },
                                        "status": {
                                            "type": "string"
                                        },
                                        "deposit_status": {
                                            "type": "string"
                                        },
                                        "deposit_retained": {
                                            "type": "number",
                                            "nullable": true
                                        },
                                        "cancellation_reason": {
                                            "type": "string",
                                            "nullable": true
                                        },
                                        "items": {
                                            "type": "array",
                                            "items": {
                                                "properties": {
                                                    "id": {
                                                        "type": "string",
                                                        "format": "uuid"
                                                    },
                                                    "bike_id": {
                                                        "type": "string",
                                                        "format": "uuid"
                                                    },
                                                    "bike_brand": {
                                                        "type": "string"
                                                    },
                                                    "bike_model": {
                                                        "type": "string"
                                                    },
                                                    "bike_internal_number": {
                                                        "type": "string"
                                                    },
                                                    "daily_rate": {
                                                        "type": "number"
                                                    },
                                                    "quantity": {
                                                        "type": "integer"
                                                    },
                                                    "client_height": {
                                                        "type": "integer",
                                                        "nullable": true
                                                    },
                                                    "client_weight": {
                                                        "type": "integer",
                                                        "nullable": true
                                                    },
                                                    "saddle_height": {
                                                        "type": "integer",
                                                        "nullable": true
                                                    },
                                                    "front_suspension_pressure": {
                                                        "type": "integer",
                                                        "nullable": true
                                                    },
                                                    "rear_suspension_pressure": {
                                                        "type": "integer",
                                                        "nullable": true
                                                    },
                                                    "pedal_type": {
                                                        "type": "string",
                                                        "nullable": true
                                                    },
                                                    "check_in_notes": {
                                                        "type": "string",
                                                        "nullable": true
                                                    },
                                                    "return_condition": {
                                                        "type": "string",
                                                        "nullable": true
                                                    },
                                                    "damage_description": {
                                                        "type": "string",
                                                        "nullable": true
                                                    },
                                                    "damage_photos": {
                                                        "type": "array",
                                                        "items": {
                                                            "type": "string"
                                                        }
                                                    }
                                                },
                                                "type": "object"
                                            }
                                        },
                                        "equipments": {
                                            "type": "array",
                                            "items": {
                                                "properties": {
                                                    "id": {
                                                        "type": "string",
                                                        "format": "uuid"
                                                    },
                                                    "type": {
                                                        "type": "string"
                                                    },
                                                    "quantity": {
                                                        "type": "integer"
                                                    },
                                                    "price_per_unit": {
                                                        "type": "number"
                                                    }
                                                },
                                                "type": "object"
                                            }
                                        },
                                        "created_at": {
                                            "type": "string",
                                            "format": "date-time"
                                        },
                                        "updated_at": {
                                            "type": "string",
                                            "format": "date-time"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires view_rentals permission"
                    },
                    "404": {
                        "description": "Rental not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/rentals/active": {
            "get": {
                "tags": [
                    "Rentals"
                ],
                "summary": "List active rentals",
                "operationId": "7d25fd68ae5d2f3c08b6b84c481359a4",
                "parameters": [
                    {
                        "name": "customer_id",
                        "in": "query",
                        "description": "Filter by customer ID",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    },
                    {
                        "name": "bike_id",
                        "in": "query",
                        "description": "Filter by bike ID",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    },
                    {
                        "name": "only_late",
                        "in": "query",
                        "description": "Show only late rentals",
                        "required": false,
                        "schema": {
                            "type": "boolean"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of active rentals with delay indicators (on_time, soon_late, late)"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires view_rentals permission"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/maintenance/reasons": {
            "get": {
                "tags": [
                    "Maintenance"
                ],
                "summary": "List all maintenance categories and reasons",
                "operationId": "5016ccfd00551aec0d81b1f03bdc9823",
                "responses": {
                    "200": {
                        "description": "List of maintenance categories with their associated reasons",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "categories": {
                                            "type": "array",
                                            "items": {
                                                "properties": {
                                                    "code": {
                                                        "type": "string",
                                                        "example": "transmission"
                                                    },
                                                    "label": {
                                                        "type": "string",
                                                        "example": "Transmission"
                                                    },
                                                    "reasons": {
                                                        "type": "array",
                                                        "items": {
                                                            "properties": {
                                                                "code": {
                                                                    "type": "string",
                                                                    "example": "chain_replacement"
                                                                },
                                                                "label": {
                                                                    "type": "string",
                                                                    "example": "Remplacement chaîne"
                                                                }
                                                            },
                                                            "type": "object"
                                                        }
                                                    }
                                                },
                                                "type": "object"
                                            }
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires view_maintenance permission"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/maintenance/maintenances": {
            "get": {
                "tags": [
                    "Maintenance"
                ],
                "summary": "List maintenances with filters",
                "operationId": "280006ba3667180517b258fbe596960a",
                "parameters": [
                    {
                        "name": "status",
                        "in": "query",
                        "description": "Filter by status",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "enum": [
                                "todo",
                                "in_progress",
                                "completed",
                                "cancelled"
                            ]
                        }
                    },
                    {
                        "name": "priority",
                        "in": "query",
                        "description": "Filter by priority",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "enum": [
                                "low",
                                "normal",
                                "urgent"
                            ]
                        }
                    },
                    {
                        "name": "type",
                        "in": "query",
                        "description": "Filter by type",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "enum": [
                                "preventive",
                                "curative"
                            ]
                        }
                    },
                    {
                        "name": "bike_id",
                        "in": "query",
                        "description": "Filter by bike",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    },
                    {
                        "name": "category",
                        "in": "query",
                        "description": "Filter by maintenance category",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "enum": [
                                "transmission",
                                "brakes",
                                "suspension",
                                "wheels",
                                "steering",
                                "frame",
                                "electrical",
                                "full_service",
                                "other"
                            ]
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of maintenances"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires view_maintenance permission"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "Maintenance"
                ],
                "summary": "Declare a new maintenance for a bike",
                "operationId": "d1d513bdaf8dc15cbaf75440bc27095a",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "bike_id",
                                    "type",
                                    "reason",
                                    "priority"
                                ],
                                "properties": {
                                    "bike_id": {
                                        "type": "string",
                                        "format": "uuid",
                                        "example": "550e8400-e29b-41d4-a716-446655440000"
                                    },
                                    "type": {
                                        "type": "string",
                                        "enum": [
                                            "preventive",
                                            "curative"
                                        ],
                                        "example": "curative"
                                    },
                                    "reason": {
                                        "description": "Maintenance reason code from /api/maintenance/reasons",
                                        "type": "string",
                                        "example": "chain_replacement"
                                    },
                                    "priority": {
                                        "type": "string",
                                        "enum": [
                                            "low",
                                            "normal",
                                            "urgent"
                                        ],
                                        "example": "normal"
                                    },
                                    "scheduled_at": {
                                        "type": "string",
                                        "format": "date-time",
                                        "example": "2024-03-20T09:00:00Z"
                                    },
                                    "notes": {
                                        "type": "string",
                                        "example": "Chaîne très usée, à remplacer rapidement",
                                        "nullable": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Maintenance declared successfully"
                    },
                    "400": {
                        "description": "Validation error or bike not available for maintenance"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_maintenance permission"
                    },
                    "404": {
                        "description": "Bike not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/maintenance/maintenances/{id}/start": {
            "put": {
                "tags": [
                    "Maintenance"
                ],
                "summary": "Start a maintenance",
                "operationId": "2a6baa7be8a01c1abb419400774bbcea",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "requestBody": {
                    "required": false,
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "notes": {
                                        "type": "string",
                                        "example": "Début de la maintenance",
                                        "nullable": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Maintenance started, bike status changed to MAINTENANCE"
                    },
                    "400": {
                        "description": "Maintenance cannot be started (not in TODO status)"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_maintenance permission"
                    },
                    "404": {
                        "description": "Maintenance not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/maintenance/maintenances/{id}/complete": {
            "put": {
                "tags": [
                    "Maintenance"
                ],
                "summary": "Complete a maintenance",
                "operationId": "cd542ea027648b03176a813fa645ca0b",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "requestBody": {
                    "required": false,
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "parts_cost": {
                                        "description": "Cost of parts in euros",
                                        "type": "number",
                                        "format": "float",
                                        "example": 25.5,
                                        "nullable": true
                                    },
                                    "labor_cost": {
                                        "description": "Labor cost in euros",
                                        "type": "number",
                                        "format": "float",
                                        "example": 15,
                                        "nullable": true
                                    },
                                    "notes": {
                                        "type": "string",
                                        "example": "Chaîne remplacée, vélo prêt",
                                        "nullable": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Maintenance completed, bike status changed to AVAILABLE"
                    },
                    "400": {
                        "description": "Maintenance cannot be completed (not in IN_PROGRESS status)"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires manage_maintenance permission"
                    },
                    "404": {
                        "description": "Maintenance not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/maintenance/bikes/{bikeId}/maintenances": {
            "get": {
                "tags": [
                    "Maintenance"
                ],
                "summary": "Get maintenance history for a specific bike",
                "operationId": "dc1adf6d7a778032b25ae0063cb223fb",
                "parameters": [
                    {
                        "name": "bikeId",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of all maintenances for this bike"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires view_maintenance permission"
                    },
                    "404": {
                        "description": "Bike not found"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/dashboard/overview": {
            "get": {
                "tags": [
                    "Dashboard"
                ],
                "summary": "Get fleet overview (US 6.1)",
                "operationId": "b872d1c86237dee42c76a07ac7862869",
                "responses": {
                    "200": {
                        "description": "Fleet overview with status counts",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "total_bikes": {
                                            "type": "integer",
                                            "example": 50
                                        },
                                        "by_status": {
                                            "properties": {
                                                "available": {
                                                    "type": "integer",
                                                    "example": 30
                                                },
                                                "rented": {
                                                    "type": "integer",
                                                    "example": 15
                                                },
                                                "maintenance": {
                                                    "type": "integer",
                                                    "example": 4
                                                },
                                                "retired": {
                                                    "type": "integer",
                                                    "example": 1
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "active_rentals": {
                                            "type": "integer",
                                            "example": 15
                                        },
                                        "total_customers": {
                                            "type": "integer",
                                            "example": 120
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires view_dashboard permission"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/dashboard/today": {
            "get": {
                "tags": [
                    "Dashboard"
                ],
                "summary": "Get today's activity (US 6.2)",
                "operationId": "8144452e56ab40deb5977ad2414ebd3b",
                "parameters": [
                    {
                        "name": "date",
                        "in": "query",
                        "description": "Specific date to query (defaults to today)",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "format": "date"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Today's activity details",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "date": {
                                            "type": "string",
                                            "format": "date",
                                            "example": "2024-03-15"
                                        },
                                        "rentals": {
                                            "properties": {
                                                "starting_today": {
                                                    "type": "integer",
                                                    "example": 5
                                                },
                                                "returning_today": {
                                                    "type": "integer",
                                                    "example": 3
                                                },
                                                "late_returns": {
                                                    "type": "integer",
                                                    "example": 1
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "maintenances": {
                                            "properties": {
                                                "scheduled_today": {
                                                    "type": "integer",
                                                    "example": 2
                                                },
                                                "completed_today": {
                                                    "type": "integer",
                                                    "example": 1
                                                },
                                                "urgent_pending": {
                                                    "type": "integer",
                                                    "example": 0
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "details": {
                                            "properties": {
                                                "starting_rentals": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object"
                                                    }
                                                },
                                                "expected_returns": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object"
                                                    }
                                                },
                                                "scheduled_maintenances": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object"
                                                    }
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires view_dashboard permission"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/dashboard/kpis/utilization": {
            "get": {
                "tags": [
                    "Dashboard - KPIs"
                ],
                "summary": "Get utilization KPIs (US 6.3)",
                "operationId": "ce78c8817c8c264065780bf90d9ffa04",
                "parameters": [
                    {
                        "name": "period",
                        "in": "query",
                        "description": "Period for KPI calculation (default: month)",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "enum": [
                                "day",
                                "week",
                                "month",
                                "year"
                            ]
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Utilization KPIs",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "utilization_rate": {
                                            "description": "Percentage of fleet utilization",
                                            "type": "number",
                                            "format": "float",
                                            "example": 72.5
                                        },
                                        "average_rental_duration_hours": {
                                            "type": "number",
                                            "format": "float",
                                            "example": 4.5
                                        },
                                        "total_rentals_period": {
                                            "type": "integer",
                                            "example": 150
                                        },
                                        "period": {
                                            "type": "string",
                                            "example": "month"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires view_dashboard permission"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/dashboard/kpis/revenue": {
            "get": {
                "tags": [
                    "Dashboard - KPIs"
                ],
                "summary": "Get revenue KPIs (US 6.3)",
                "operationId": "41f2c3699e62bc4e0ef9bb63a1cc6a79",
                "parameters": [
                    {
                        "name": "period",
                        "in": "query",
                        "description": "Period for KPI calculation (default: month)",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "enum": [
                                "day",
                                "week",
                                "month",
                                "year"
                            ]
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Revenue KPIs",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "total_revenue": {
                                            "description": "Total revenue in euros",
                                            "type": "number",
                                            "format": "float",
                                            "example": 12500
                                        },
                                        "rev_pav": {
                                            "description": "Revenue Per Available Vehicle",
                                            "type": "number",
                                            "format": "float",
                                            "example": 250
                                        },
                                        "average_ticket": {
                                            "description": "Average rental amount",
                                            "type": "number",
                                            "format": "float",
                                            "example": 45.5
                                        },
                                        "period": {
                                            "type": "string",
                                            "example": "month"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires view_dashboard permission"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/dashboard/kpis/maintenance": {
            "get": {
                "tags": [
                    "Dashboard - KPIs"
                ],
                "summary": "Get maintenance KPIs (US 6.3)",
                "operationId": "c089d7efbec64dc7a8a2275b928c3da5",
                "parameters": [
                    {
                        "name": "period",
                        "in": "query",
                        "description": "Period for KPI calculation (default: month)",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "enum": [
                                "day",
                                "week",
                                "month",
                                "year"
                            ]
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Maintenance KPIs",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "total_maintenances": {
                                            "type": "integer",
                                            "example": 25
                                        },
                                        "mttr_hours": {
                                            "description": "Mean Time To Repair in hours",
                                            "type": "number",
                                            "format": "float",
                                            "example": 4.2
                                        },
                                        "maintenance_cost": {
                                            "description": "Total maintenance cost in euros",
                                            "type": "number",
                                            "format": "float",
                                            "example": 850
                                        },
                                        "by_type": {
                                            "properties": {
                                                "preventive": {
                                                    "type": "integer",
                                                    "example": 15
                                                },
                                                "curative": {
                                                    "type": "integer",
                                                    "example": 10
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "period": {
                                            "type": "string",
                                            "example": "month"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires view_dashboard permission"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/dashboard/kpis/top-bikes": {
            "get": {
                "tags": [
                    "Dashboard - KPIs"
                ],
                "summary": "Get top performing bikes (US 6.3)",
                "operationId": "f5ad3b841d9013cf94b4b5fe2d753896",
                "parameters": [
                    {
                        "name": "limit",
                        "in": "query",
                        "description": "Number of bikes to return",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "default": 10
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Top performing bikes by revenue and rentals",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "top_bikes": {
                                            "type": "array",
                                            "items": {
                                                "properties": {
                                                    "bike_id": {
                                                        "type": "string",
                                                        "format": "uuid"
                                                    },
                                                    "internal_number": {
                                                        "type": "string",
                                                        "example": "VTT-001"
                                                    },
                                                    "brand_name": {
                                                        "type": "string",
                                                        "example": "Giant"
                                                    },
                                                    "model_name": {
                                                        "type": "string",
                                                        "example": "Trance X"
                                                    },
                                                    "total_rentals": {
                                                        "type": "integer",
                                                        "example": 45
                                                    },
                                                    "total_revenue": {
                                                        "type": "number",
                                                        "format": "float",
                                                        "example": 2250
                                                    }
                                                },
                                                "type": "object"
                                            }
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires view_dashboard permission"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/dashboard/alerts": {
            "get": {
                "tags": [
                    "Dashboard"
                ],
                "summary": "Get centralized alerts (US 6.4)",
                "operationId": "895ff533cebc3f12dbff65503ed3d9e3",
                "responses": {
                    "200": {
                        "description": "Centralized alerts from all sources",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "alerts": {
                                            "type": "array",
                                            "items": {
                                                "properties": {
                                                    "type": {
                                                        "type": "string",
                                                        "enum": [
                                                            "late_return",
                                                            "urgent_maintenance",
                                                            "bike_long_unavailable",
                                                            "maintenance_long_running"
                                                        ]
                                                    },
                                                    "severity": {
                                                        "type": "string",
                                                        "enum": [
                                                            "high",
                                                            "medium",
                                                            "low"
                                                        ]
                                                    },
                                                    "message": {
                                                        "type": "string",
                                                        "example": "Retour en retard de 2 jour(s)"
                                                    },
                                                    "rental_id": {
                                                        "type": "string",
                                                        "format": "uuid",
                                                        "nullable": true
                                                    },
                                                    "maintenance_id": {
                                                        "type": "string",
                                                        "format": "uuid",
                                                        "nullable": true
                                                    },
                                                    "bike_id": {
                                                        "type": "string",
                                                        "format": "uuid",
                                                        "nullable": true
                                                    },
                                                    "customer_id": {
                                                        "type": "string",
                                                        "format": "uuid",
                                                        "nullable": true
                                                    },
                                                    "created_at": {
                                                        "type": "string",
                                                        "format": "date-time"
                                                    }
                                                },
                                                "type": "object"
                                            }
                                        },
                                        "counts_by_severity": {
                                            "properties": {
                                                "high": {
                                                    "type": "integer",
                                                    "example": 3
                                                },
                                                "medium": {
                                                    "type": "integer",
                                                    "example": 5
                                                },
                                                "low": {
                                                    "type": "integer",
                                                    "example": 2
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "total": {
                                            "type": "integer",
                                            "example": 10
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires view_dashboard permission"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/rentals/bikes/{bikeId}": {
            "get": {
                "tags": [
                    "Rentals"
                ],
                "summary": "Get all rentals for a specific bike",
                "operationId": "96325619ef39b51742a52897c4573d26",
                "parameters": [
                    {
                        "name": "bikeId",
                        "in": "path",
                        "description": "Bike ID",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid"
                        }
                    },
                    {
                        "name": "filter",
                        "in": "query",
                        "description": "Filter rentals by status: all (default), past (completed/cancelled), current (active), upcoming (pending)",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "default": "all",
                            "enum": [
                                "all",
                                "past",
                                "current",
                                "upcoming"
                            ]
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of rentals for the bike",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "bike_id": {
                                            "type": "string",
                                            "format": "uuid"
                                        },
                                        "total_count": {
                                            "type": "integer",
                                            "example": 15
                                        },
                                        "rentals": {
                                            "type": "array",
                                            "items": {
                                                "properties": {
                                                    "id": {
                                                        "type": "string",
                                                        "format": "uuid"
                                                    },
                                                    "customer_id": {
                                                        "type": "string",
                                                        "format": "uuid"
                                                    },
                                                    "start_date": {
                                                        "type": "string",
                                                        "format": "date-time",
                                                        "example": "2024-01-15 10:00:00"
                                                    },
                                                    "expected_return_date": {
                                                        "type": "string",
                                                        "format": "date-time",
                                                        "example": "2024-01-20 18:00:00"
                                                    },
                                                    "actual_return_date": {
                                                        "type": "string",
                                                        "format": "date-time",
                                                        "example": "2024-01-20 17:30:00",
                                                        "nullable": true
                                                    },
                                                    "status": {
                                                        "type": "string",
                                                        "enum": [
                                                            "pending",
                                                            "active",
                                                            "completed",
                                                            "cancelled"
                                                        ]
                                                    },
                                                    "total_amount": {
                                                        "type": "number",
                                                        "format": "float",
                                                        "example": 350
                                                    },
                                                    "deposit_amount": {
                                                        "type": "number",
                                                        "format": "float",
                                                        "example": 200
                                                    },
                                                    "deposit_status": {
                                                        "type": "string",
                                                        "enum": [
                                                            "held",
                                                            "released",
                                                            "partial",
                                                            "retained"
                                                        ]
                                                    },
                                                    "deposit_retained": {
                                                        "type": "number",
                                                        "format": "float",
                                                        "example": 50,
                                                        "nullable": true
                                                    },
                                                    "cancellation_reason": {
                                                        "type": "string",
                                                        "example": "Customer request",
                                                        "nullable": true
                                                    }
                                                },
                                                "type": "object"
                                            }
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad Request - Invalid filter parameter"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - requires view_rentals permission"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        }
    },
    "components": {
        "securitySchemes": {
            "bearerAuth": {
                "type": "http",
                "bearerFormat": "JWT",
                "scheme": "bearer"
            }
        }
    },
    "tags": [
        {
            "name": "Auth",
            "description": "Auth"
        },
        {
            "name": "Users",
            "description": "Users"
        },
        {
            "name": "Customers",
            "description": "Customers"
        },
        {
            "name": "Fleet - Brands",
            "description": "Fleet - Brands"
        },
        {
            "name": "Fleet - Models",
            "description": "Fleet - Models"
        },
        {
            "name": "Fleet - Bikes",
            "description": "Fleet - Bikes"
        },
        {
            "name": "Fleet - Categories",
            "description": "Fleet - Categories"
        },
        {
            "name": "Fleet - Rates",
            "description": "Fleet - Rates"
        },
        {
            "name": "Rentals",
            "description": "Rentals"
        },
        {
            "name": "Maintenance",
            "description": "Maintenance"
        },
        {
            "name": "Dashboard",
            "description": "Dashboard"
        },
        {
            "name": "Dashboard - KPIs",
            "description": "Dashboard - KPIs"
        }
    ]
}